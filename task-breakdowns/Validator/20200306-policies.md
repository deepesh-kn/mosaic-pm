# Policies
**Please note that this is a draft version**

The behavior of the validator executable is defined by the policy. 
When the validator starts, the policy can be defined in the manifest file. Depending upon the policy the validator can change its behavior.
To start with the first version of validator will have the simple policy.
The [Avatar](20200306-avatars.md) will use the policies to determine if it needs to perform any actions.

The simple policy is defined below.
1. **CommitteeCooldownPolicy**
    - Get the `activationBlockHeight` from the `CommitteeModel`.
    - Get the `blockHash` from the `CommitteeModel`.
    - Get the latest `blockHeight` from `BlockHistoryModel`.
    - Check if the `activationBlockHeight` is less than `blockHeight`.
    - Check if the `activationBlockHeight` is finalized.
    - Check that the `blockHash` exists in the `BlockHistoryModel`.
    - Check if the `Committee.Status` is `Open`.
    - Return `true`.
1. **CommitteeActivate**
    - The `status` of committee should be `CoolDownPhase`.
    - Get the `activationBlockHeight` from the `CommitteeModel`.
    - Check if the latest `blockHeight` from `BlockHistoryModel` is greater than `activationBlockHeight` from the `CommitteeModel`. TODO: how to get this?
    - The `blockHash` from the `CommitteeExtendedModel` for status `CoolDownPhase` must exists in the `BlockHistoryModel`.
    - return `true`.
1. **CommitteeSubmitSealedCommit**
    - Calculate the seal from the `committeeSolution` from `TransitionObject` model. 
    - The `status` of committee must be in the `CommitPhase`.
    - The `blockHash` from the `CommitteeExtendedModel` for status `CommitPhase` must exists in the `BlockHistoryModel` as a valid history.
    - return the seal. (otherwise, null).
1. **CommitteeChallenge**
    - Not in scope for version 1.
1. **CommitteeCloseCommitPhase**
    - The `status` of the committee must be in the `CommitPhase`.
    - The `blockHash` from the `CommitteeExtendedModel` for status `CommitPhase` must exists in the `BlockHistoryModel` as a valid history.
    - The current block number from the `BlockHistoryModel` must be greater than the `commitTimeOutBlockHeight`
    - return `true`.
1. **CommitteeRevealCommit**
    - The `status` of the committee must be `RevealPhase`.
    - The `blockHash` from the `CommitteeExtendedModel` for status `RevealPhase` must exists in the `BlockHistoryModel` as a valid history.
    - return `true`.
1. **CommitMetablock**
    - The param passed is `CommitMetablockModel` object.
    - The `blockHash` from the `Metablock` must exist in the `BlockHistoryModel` as a valid history.
    - return `true`.
1. **CommitCheckpoint**
    - The param passed is `CommitCheckpointModel`
    - The `blockHash` from `CommitCheckpointModel` must exist in the `BlockHistoryModel` as a valid history.
    - The `CoopenedBlockNumber` must be finalized.
    - return `true`.
1. **ObserveBlock**
    - The param passed is `ObserveBlock`.
    - The `blockHash` from the `ObserveBlock` must exist in the `BlockHistoryModel` as a valid history.
    - The `blockNumber` must be finalized.
    - return `true`.
1. **FormCommittee**
    - The param passed is `FormCommitteeModel`
    - The `round` of Metablock must be `Precommitted`
    - The `blockHash` of Metablock must exist in the `BlockHistoryModel` as a valid history.
    - The `blockNumber` from `BlockHistoryModel` must be greater than `committeeFormationBlockHeight`
    - return true. 
1. **EnterCommittee**
    - The param passed is `EnterCommitteeModel`.
    - The `round` of Metablock must be `CommitteeFormed`
    - The `blockHash` of Metablock must exist in the `BlockHistoryModel` as a valid history.
    - The `roundMetablockNumber` fom Metablock must be greater than `blockNumber` from `BlockHistoryModel`.
1. **ConfirmOpenKernel**
    - The param passed is `ConfirmOpenKernelMode`.
    - The `blockhash` from the `ConfirmOpenKernelModel` must exists in `BlockHistoryModel` as a valid history.
    - return true.
1. **ProposeMetablock**
    - The param passed is `ProposeMetablockModel`.
    - The `voteMessageHash` value should exist in `Link` model
    - The `targetFinalizationStatus` must be finalized.
    - The `targetBlockHash` must exist in the `BlockHistoryModel` as a valid history.
    - The `Metablock` model must not have `metablockHash` as `voteMessageHash` value.
1. **ProposeLink**
    - The param passed is `ProposeLinkModel`.
    - The `targetBlockNumber` must be a epoch length.
    - The `targetBlockHash` must exist in the `BlockHistoryModel` as a valid history.
    - The leaf `targetBlockHash` form the Link should also be a valid ancestor of `targetBlockHash`.
    - return `true`.
1. **RegisterVote**
    - The param passed is `RegisterVoteModel`.
    - Check that `voteMessageHash` already exists in `Link` model.
    - The `targetBlockHash` must exist in the `BlockHistoryModel` as a valid history.
    - The `targetFinalizationStatus` must be `justified` or `Registered`.
    - The vote is not already registered.
    - return `true`.
    